<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Q and P matrices · SubstitutionModels.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SubstitutionModels.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../models/">Substitution models</a></li><li class="current"><a class="toctext" href>Q and P matrices</a><ul class="internal"></ul></li><li><a class="toctext" href="../modeltypes/">Provided models &amp; custom models</a></li></ul></li><li><a class="toctext" href="../../contributing/">Contributing</a></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href>Q and P matrices</a></li></ul><a class="edit-page" href="https://github.com/BioJulia/SubstitutionModels.jl/blob/master/docs/src/man/pqmatrices.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Q and P matrices</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Q-and-P-Matrices-1" href="#Q-and-P-Matrices-1">Q and P Matrices</a></h1><p>Evolutionary analyses of sequences are conducted on a wide variety of time scales.</p><p>Thus, it is convenient to express these models in terms of the instantaneous rates of change between different states. This representation of the model is typically called the model&#39;s Q Matrix.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SubstitutionModels.Q" href="#SubstitutionModels.Q"><code>SubstitutionModels.Q</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Generate a Q matrix for a <code>NucleicAcidSubstitutionModel</code>, of the form:</p><div>\[Q = \begin{bmatrix}
Q_{A, A} &amp; Q_{A, C} &amp; Q_{A, G} &amp; Q_{A, T} \\
Q_{C, A} &amp; Q_{C, C} &amp; Q_{C, G} &amp; Q_{C, T} \\
Q_{G, A} &amp; Q_{G, C} &amp; Q_{G, G} &amp; Q_{G, T} \\
Q_{T, A} &amp; Q_{T, C} &amp; Q_{T, G} &amp; Q_{T, T} \end{bmatrix}\]</div><p>Call as either</p><ol><li><code>Q(model)</code>, or</li><li><code>Q(model, bool)</code></li></ol><p>Form (2) scales the matrix so that <span>$_π(model) ⋅ -diag(Q(model)) = 1$</span> when bool=true. <code>Q(model, false)</code> is equivalent to <code>Q(model)</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/SubstitutionModels.jl/blob/da1e2794b8c4164980ff188a4662ee3d83d42b18/src/nucleic_acid/nucleic_acid.jl#L12-L26">source</a></section><p>If we are given a starting state at one position in a DNA sequence, the model&#39;s Q matrix and a branch length expressing the expected number of changes to have occurred since the ancestor, then we can derive the probability of the descendant sequence having each of the four states.</p><p>This transformation from the instantaneous rate matrix (Q Matrix), to a probability matrix for a given time period (P Matrix), is described <a href="../modeltypes/#pcomp-1">here</a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SubstitutionModels.P" href="#SubstitutionModels.P"><code>SubstitutionModels.P</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Generate a P matrix for a <code>NucleicAcidSubstitutionModel</code>, of the form:</p><div>\[P = \begin{bmatrix}
P_{A, A} &amp; P_{A, C} &amp; P_{A, G} &amp; P_{A, T} \\
P_{C, A} &amp; P_{C, C} &amp; P_{C, G} &amp; P_{C, T} \\
P_{G, A} &amp; P_{G, C} &amp; P_{G, G} &amp; P_{G, T} \\
P_{T, A} &amp; P_{T, C} &amp; P_{T, G} &amp; P_{T, T} \end{bmatrix}\]</div><p>for specified time</p><p>Call as either</p><ol><li><code>P(model, t)</code>, or</li><li><code>P(model, t, bool)</code></li></ol><p>Form (2) obtains its probabilities from the scaled Q matrix if bool=true. Branch lengths estimated from a scaled P matrix are in units of expected number of substitutions per site. <code>P(model, t, false)</code> is equivalent to <code>P(model, t)</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/BioJulia/SubstitutionModels.jl/blob/da1e2794b8c4164980ff188a4662ee3d83d42b18/src/nucleic_acid/nucleic_acid.jl#L120-L138">source</a></section><footer><hr/><a class="previous" href="../models/"><span class="direction">Previous</span><span class="title">Substitution models</span></a><a class="next" href="../modeltypes/"><span class="direction">Next</span><span class="title">Provided models &amp; custom models</span></a></footer></article></body></html>
