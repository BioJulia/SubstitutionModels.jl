var documenterSearchIndex = {"docs":
[{"location":"#SubstitutionModels.jl-1","page":"Home","title":"SubstitutionModels.jl","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Release status:","category":"page"},{"location":"#","page":"Home","title":"Home","text":"(Image: Latest Release) (Image: License) (Image: ) (Image: BioJulia maintainer: jangevaare) (Image: BioJulia maintainer: Ward9250)","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Development status:","category":"page"},{"location":"#","page":"Home","title":"Home","text":"(Image: Build Status) (Image: codecov.io) (Image: )","category":"page"},{"location":"#Description-1","page":"Home","title":"Description","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"SubstitutionModels.jl provides facilities to model the substitution process of biological sequences. Such models are essential for the analysis of sequence evolution, phylogenetics, and simulation.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"We first aim to provide the most common substitution models used in the literature, but aim to build an extendable framework using julia's type system and traits, so as custom model types can be created and used.","category":"page"},{"location":"#Installation-1","page":"Home","title":"Installation","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"The current release version can be installed from the Julia REPL:","category":"page"},{"location":"#","page":"Home","title":"Home","text":"julia> using Pkg\njulia> add(\"SubstitutionModels\")","category":"page"},{"location":"#Contributing-and-Questions-1","page":"Home","title":"Contributing and Questions","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"We appreciate contributions from users including reporting bugs, fixing issues, improving performance and adding new features. Please go to the contributing section of the documentation for more information.","category":"page"},{"location":"#","page":"Home","title":"Home","text":"If you have a question about contributing or using this package, you are encouraged to use the Bio category of the Julia discourse site.","category":"page"},{"location":"man/models/#SubstitutionModels.jl-1","page":"Substitution models","title":"SubstitutionModels.jl","text":"","category":"section"},{"location":"man/models/#What-are-subsitution-models?-1","page":"Substitution models","title":"What are subsitution models?","text":"","category":"section"},{"location":"man/models/#","page":"Substitution models","title":"Substitution models","text":"Substitution models are phenomenological descriptions of the evolution of genetic code. These models are Markovian, and do not explicitly depict mechanisms such as mutation or natural selection. Rather, they describe the relative rates of different changes, and those rates are assumed the capture the action of those mechanisms.","category":"page"},{"location":"man/models/#","page":"Substitution models","title":"Substitution models","text":"For example, when examining aligned sequences, a high number of transition substitutions are observed vs. the number of transversion substitutions. The mechanisms that cause this differential include mutation biases, and the action of purifying selection. However, the Kimura (K80) substitution model merely attempts to capture the effect of both of those mechanisms, rather than modelling the mechanisms themselves, by using a parameter that reflects the relative rate of transitions to transversions.","category":"page"},{"location":"man/models/#","page":"Substitution models","title":"Substitution models","text":"Models describing the substitution rates of nucleic acids, and amino acids both exist. Currently only nucleic acid substitution models are implemented in SubstitutionModels.jl.","category":"page"},{"location":"man/models/#Representation-of-models-in-code:-1","page":"Substitution models","title":"Representation of models in code:","text":"","category":"section"},{"location":"man/models/#","page":"Substitution models","title":"Substitution models","text":"NucleicAcidSubstitutionModel","category":"page"},{"location":"man/models/#SubstitutionModels.NucleicAcidSubstitutionModel","page":"Substitution models","title":"SubstitutionModels.NucleicAcidSubstitutionModel","text":"NucleicAcidSubstitutionModel is an abstract type that contains all models describing a substitution process impacting biological sequences of DNA or RNA with continous time Markov models.\n\n\n\n\n\n","category":"type"},{"location":"man/pqmatrices/#Q-and-P-Matrices-1","page":"Q and P matrices","title":"Q and P Matrices","text":"","category":"section"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"Evolutionary analyses of sequences are conducted on a wide variety of time scales.","category":"page"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"Thus, it is convenient to express these models in terms of the instantaneous rates of change between different states. This representation of the model is typically called the model's Q Matrix.","category":"page"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"Q","category":"page"},{"location":"man/pqmatrices/#SubstitutionModels.Q","page":"Q and P matrices","title":"SubstitutionModels.Q","text":"Generate a Q matrix for a NucleicAcidSubstitutionModel, of the form:\n\nQ = beginbmatrix\nQ_A A  Q_A C  Q_A G  Q_A T \nQ_C A  Q_C C  Q_C G  Q_C T \nQ_G A  Q_G C  Q_G G  Q_G T \nQ_T A  Q_T C  Q_T G  Q_T T endbmatrix\n\nCall as either\n\nQ(model), or\nQ(model, bool)\n\nForm (2) scales the matrix so that _π(model)  -diag(Q(model)) = 1 when bool=true. Q(model, false) is equivalent to Q(model).\n\n\n\n\n\n","category":"function"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"If we are given a starting state at one position in a DNA sequence, the model's Q matrix and a branch length expressing the expected number of changes to have occurred since the ancestor, then we can derive the probability of the descendant sequence having each of the four states.","category":"page"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"This transformation from the instantaneous rate matrix (Q Matrix), to a probability matrix for a given time period (P Matrix), is described here.","category":"page"},{"location":"man/pqmatrices/#","page":"Q and P matrices","title":"Q and P matrices","text":"P","category":"page"},{"location":"man/pqmatrices/#SubstitutionModels.P","page":"Q and P matrices","title":"SubstitutionModels.P","text":"Generate a P matrix for a NucleicAcidSubstitutionModel, of the form:\n\nP = beginbmatrix\nP_A A  P_A C  P_A G  P_A T \nP_C A  P_C C  P_C G  P_C T \nP_G A  P_G C  P_G G  P_G T \nP_T A  P_T C  P_T G  P_T T endbmatrix\n\nfor specified time\n\nCall as either\n\nP(model, t), or\nP(model, t, bool)\n\nForm (2) obtains its probabilities from the scaled Q matrix if bool=true. Branch lengths estimated from a scaled P matrix are in units of expected number of substitutions per site. P(model, t, false) is equivalent to P(model, t).\n\n\n\n\n\n","category":"function"},{"location":"man/modeltypes/#Nucleic-Acid-Substitution-Models-1","page":"Provided models & custom models","title":"Nucleic Acid Substitution Models","text":"","category":"section"},{"location":"man/modeltypes/#Included-Substitution-Models-1","page":"Provided models & custom models","title":"Included Substitution Models","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Absolute and relative rate forms of the following common substitution models are currently included in SubstitutionModels.jl:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"JC69\nK80\nF81\nF84\nHKY85\nTN93\nGTR","category":"page"},{"location":"man/modeltypes/#Construction-1","page":"Provided models & custom models","title":"Construction","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"For the convenience of the user, several construction methods exist for each substitution model. Each models are represented by immutable structs; i.e. once constructed, model parameters can not be changed.","category":"page"},{"location":"man/modeltypes/#Method-1-1","page":"Provided models & custom models","title":"Method 1","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"The most basic construction method detects whether the absolute or relative rate form of a substitution model is being referenced based on the number of parameters, and constructs it:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"K80(1e-2)\n\n# output\nKimura 1980 model (relative rate form)\nκ = 0.01","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Substitution model construction involves a number of checks for parameter validity, though these may be optionally bypassed:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"K80(-1e-2, false)\n\n# output\nKimura 1980 model (relative rate form)\nκ = -0.01","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"The exact model type may be specific as well, to avoid the software detection of absolute or relative rate specification. The specific forms are the parent models' name followed by abs for absolute or rel for relative rate form.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"K80rel<:K80, K80abs<:K80\n\n# output\n(true, true)","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"K80abs(1e-2, 1.5e-2)\n\n# output\nKimura 1980 model (absolute rate form)\nα = 0.01, β = 0.015","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"For models requiring specification of base frequencies, those can be provided in the same manner as the other model parameters:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"fieldnames(F81abs)\n\n# output\n(:β, :πA, :πC, :πG, :πT)","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"F81abs(1e-2, 0.2475, 0.2425, 0.2575, 0.2525)\n\n# output\nFelsenstein 1981 model (absolute rate form)\nβ = 0.01, π = [0.2475, 0.2425, 0.2575, 0.2525]","category":"page"},{"location":"man/modeltypes/#Method-2-1","page":"Provided models & custom models","title":"Method 2","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"It may be familar or convenient for some SubstitutionModels.jl users to construct substitution model objects using a parameter vector of some kind. This is also a supported construction method. When specifying a model with an equal base frequency, a single parameter vector is required for construction. For models that support different base frequencies, a parameter vector and a base frequency vector are both required.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"F81abs([1e-2], [0.2475, 0.2425, 0.2575, 0.2525])\n\n# output\nFelsenstein 1981 model (absolute rate form)\nβ = 0.01, π = [0.2475, 0.2425, 0.2575, 0.2525]","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"The unsafe construction method is still available, as is auto-detection of absolute or relative rate types of substitution models.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"K80([1e-2, 1.5e-2], true)\n\n# output\nKimura 1980 model (absolute rate form)\nα = 0.01, β = 0.015","category":"page"},{"location":"man/modeltypes/#Method-3-1","page":"Provided models & custom models","title":"Method 3","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Lastly, convert methods are also provided for each substitution model type:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"convert(K80, [1e-2, 1.5e-2], true)\n\n# output\nKimura 1980 model (absolute rate form)\nα = 0.01, β = 0.015","category":"page"},{"location":"man/modeltypes/#User-defined-substitution-models-1","page":"Provided models & custom models","title":"User defined substitution models","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"The set of substitution models included in this package is easily extended with user defined types. When defining a new substitution model, the minimum requirement is that it is a subtype of NucleicAcidSubstitutionModel, and that it has a valid method for the Q function.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"There are two means of accomplishing this. The first method involves recognizing that most substitution models are special cases of the Generalized Time Reversible (GTR) model, which has a Q matrix of the form:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Q = beginbmatrix\n-(delta pi_textC + eta pi_textG + beta pi_textT)  delta pi_textC  eta pi_textG  beta pi_textT \ndelta pi_textA  -(delta pi_textA + epsilon pi_textG + alpha pi_textT)  epsilon pi_textG  alpha pi_textT \neta pi_textA  epsilon pi_textC  -(eta pi_textA + epsilon pi_textC + gamma pi_textT)  gamma pi_textT \nbeta pi_textA  alpha pi_textC  gamma pi_textG  -(beta pi_textA + alpha pi_textC + gamma pi_textG)\nendbmatrix","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Seeing this, a substitution model can be described by defining methods for the following internal functions:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"_α,\n_β,\n_γ,\n_δ,\n_ϵ, and\n_η.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"If this substitution model allows for unequal base frequencies, methods for _πA, _πC, _πG, and _πT will also need to be defined. With these, SubstitutionModels.jl will calculate the correct Q and P matrices.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"The second method of describing a new substitution model's Q matrix is to do so directly by defining a new method for the Q function.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Pull requests that provide additional substitution models are welcome.","category":"page"},{"location":"man/modeltypes/#pcomp-1","page":"Provided models & custom models","title":"P matrix calculation for user defined substitution models","text":"","category":"section"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"P matrices are calculated as follows through matrix exponentiation:","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"P = textexp left(Q times t right)","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"SubstitutionModels.jl provides generic methods that perform this exponentiation for any given substitution model (either defined in this package, or user defined).","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"However, for many well known and well defined substitution models, the P matrix has a known form.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"If that is the case, whilst calculating an approximate P matrix using the generic method, will suffice, it is advised to overload the P function with an exact method for the P matrix of the model.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Several provided models such as the Jukes and Cantor 69 model have their own exact P method.","category":"page"},{"location":"man/modeltypes/#","page":"Provided models & custom models","title":"Provided models & custom models","text":"Providing such an exact method typically results in substantial computational savings, as the computational effort of matrix exponentiation is spared.","category":"page"},{"location":"contributing/#Contributing-1","page":"Contributing","title":"Contributing","text":"","category":"section"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"We appreciate contributions from users including reporting bugs, fixing issues, improving performance and adding new features.","category":"page"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"If you have a question about contributing or using this package, you are encouraged to use the Bio category of the Julia discourse site.","category":"page"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"Detailed guidance for contributing to all BioJulia packages is provided at the BioJulia Contribution Documentation.","category":"page"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"Here we list specific details about contributing and maintainership pertaining specifically to the SubstitutionModels.jl package.","category":"page"},{"location":"contributing/#Named-maintainers-1","page":"Contributing","title":"Named maintainers","text":"","category":"section"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"The named maintainers of this package are Justin Angevarre, & Ben J. Ward. It is their responsibility to make final choices about pull requests and issues, although because of our community structure, you will find other maintainers assisting them.","category":"page"},{"location":"contributing/#Branching-model-1","page":"Contributing","title":"Branching model","text":"","category":"section"},{"location":"contributing/#","page":"Contributing","title":"Contributing","text":"The branching model used to develop and make releases of this package is that which is summarized in the BioJulia Contribution Documentation","category":"page"}]
}
